import { Image } from '@components/Image'

# Zapier

> The Botpress app for Zapier is currently in BETA. In order to use Botpress in your Zaps please [click here to obtain access](https://zapier.com/developer/public-invite/179950/2d89a44be6d7ddcae4ae23df0be19b3c/) to the private beta in Zapier.

---

![Zapier channel](/docs/content/zapier-banner.png)

## Setup Instructions

1. If you don't have a bot yet [open your Botpress Cloud dashboard](https://app.botpress.cloud/) and create one first by clicking on the "Create Bot" button.
1. Go to the [Integration Hub](https://app.botpress.cloud/hub) in Botpress Cloud.
1. Click on the Zapier integration and then click on the "Install" button and follow the steps provided to install this integration on your bot, then go to your bot and make sure the Zapier integration is enabled and configured.
1. If you don't have a Zapier account yet sign-up for one at: https://zapier.com/
1. Request BETA access to the Botpress app in Zapier by [clicking here](https://zapier.com/developer/public-invite/179950/2d89a44be6d7ddcae4ae23df0be19b3c/).
1. Create a new zap in your Zapier account and search for "Botpress" either in the Trigger or Action of your zap.
1. Zapier will guide you through the process of authenticating to your Botpress account, follow the steps provided there.
1. Once you have authenticated, when setting up the Trigger or Action of your zap to use Botpress you'll be asked for the "Webhook URL", which you can find in your Botpress Cloud dashboard inside the "Integrations" tab of your bot and then clicking on the Zapier integration.

### Using Botpress to trigger a Zapier workflow

1. If you're setting up Botpress as a Trigger in Zapier there will be an option to test the trigger and see some sample data that could be received from your bot. Use this to create the rest of your Zap.
1. To make your bot send real data to Zapier, you'll find a "Send to Zapier" action card in Botpress Studio which you can use to send data from your bot to your Zap:
   <Image src="/docs/content/zapier-action.png" alt='"Send from Zapier" action in the Studio card tray' />
1. It's recommended that you send your data in JSON format so you can send multiple value at once, as Zapier will automatically parse it. For example, you could use the following expression to send a JSON object with multiple values in the "Trigger Data" field of the "Send to Zapier" action:

   ```
   {{ JSON.stringify({ myVariable1: workflow.myVariable1, myVariable2: workflow.myVariable2 }) }}
   ```

### Using Zapier to trigger an action in your Botpress chatbot

1. If you're setting it up as an Action in Zapier, you can send custom Event Data to your bot and an optional Correlation ID which you can use to associate individual zap runs with a particular event in your bot.
1. Zapier only allows entering a single text value for the Event Data, but you can put a Code Step from Zapier before the Botpress action in your zap in order to construct an object with multiple values and then use `JSON.stringify()` in your Code Step to convert the object to a text field that you can use in the last part of your zap as the Event Data to send to Botpress.
1. To receive data from Zapier in your bot, you can use the "Event from Zapier" trigger in the Studio:
   <Image src="/docs/content/zapier-trigger.png" alt='"Event from Zapier" event in the Studio card tray' />
1. Then add an Execute Code card with the following code assuming you sent your data in JSON format:

   ```js
   workflow.zapierData = JSON.parse(event.payload.body)
   ```

1. Now the rest of your trigger workflow can use the `{{ workflow.zapierData }}` variable to access the data you sent from Zapier.

### Testing your Zapier integration

You can create an "echo" zap in Zapier to test if everything works well. For example, you can create a zap that triggers when you send a message to your bot and then sends the same message back to your bot.
Here's what a simple echo zap would look like:

<Image src="/docs/content/zapier-echo-zap.png" alt='Screenshot of a sample "echo" zap' />

The first action receives an event from the bot, and the second one sends the same event back to the bot. You can see the events you receive on the "Discover Events" button on the node containing "Events from Zapier" card.

<Image
  src="/docs/content/zapier-echo-botpress-studio.png"
  alt='Screenshot of what the "echo" looks like in the Studio'
/>
